<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    const weak = new WeakMap();
    function deepClone(val) {
      if (typeof val !== 'object'){
	  	return val
	  }
      if(Array.isArray(val)){
			return val.map(item =>  deepClone(item))
		}
      if	(weak.has(val)){
		 	return weak.get(val)
		 }
     if(typeof val === 'object'){
			 const ww = weak.set(val,val);
			 let obj = {}
		 	for (let key in val){
				obj[key] = deepClone(val[key]); 
			}
			 return obj
		 }
    
    let obj = {
      a: 1,
      b: 2,
      c: {
        d: 1
      }
    }
    obj.c.d = obj.c
    let obj2 = deepClone(obj)
    console.log(obj2, 'obj2', obj); // lhy-log
  </script>
</body>

</html>
